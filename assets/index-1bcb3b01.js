import{s as P,_ as V,o as l,c as d,b as a,k as U,p as q,q as D,d as H,r as v,j as M,e as i,u as O,g as $,w as u,F as B,f as G,l as I,t as E,B as J,v as K,m as Q}from"./index-4fe7824b.js";import{h as W,d as X,a as Y}from"./bookshelf-97225b14.js";import{a as Z}from"./page-64bb3939.js";import{s as f}from"./function-call-216768fc.js";import{N as ee}from"./index-6afe34d9.js";import{S as te}from"./index-29569b89.js";import{P as se,B as oe}from"./index-74f31b2d.js";import{E as ne}from"./index-c5fb07c2.js";import{I as ae}from"./file-2a06de25.js";import"./index-2f1714f2.js";import"./use-id-b193c290.js";const g={name:"LoadingAnimation",props:{loading:{type:Boolean,default:!1}},setup(n){return{}}},L=()=>{P(n=>({faddbf02:n.loading?997:999}))},N=g.setup;g.setup=N?(n,_)=>(L(),N(n,_)):L;const le=n=>(q("data-v-4b392758"),n=n(),D(),n),ie={class:"loading"},ce=le(()=>a("div",{class:"load"},[a("div",{class:"loading-turn-book"})],-1)),re={class:"body"};function de(n,_,m,c,C,S){return l(),d("div",ie,[ce,a("div",re,[U(n.$slots,"default",{},void 0,!0)])])}const _e=V(g,[["render",de],["__scopeId","data-v-4b392758"]]),ue={class:"history-view"},pe={class:"body"},ve=["onClick"],fe=["src","alt"],me={class:"center"},he={class:"name van-ellipsis"},ye={class:"read-to van-ellipsis"},ge=["onClick"],Ce=["onClick"],Se=["onClick"],ke={style:{display:"flex"}},we=H({__name:"index",setup(n){const _=v(!1),m=M(),c=v([]),C=v(!0);W().then(e=>{if(e.length===0){_.value=!0;return}c.value=e}).catch(e=>f(e.message));const S=e=>{Y(e.id).then(s=>{f({message:"添加成功"}),e.inShelf=!0})},A=e=>{Z(e.id,e.readToChapter.id)},o=v(!1),R=()=>o.value=!0,T=()=>c.value.forEach(e=>e.isSelect=!0),z=e=>{o.value&&(e.isSelect=!e.isSelect)},b=e=>{o.value&&(e.isSelect=!e.isSelect)},h=(e=!1)=>{if(o.value=!1,e){let s=[],p=c.value.filter(r=>r.isSelect?(s.push(r.id),!1):!0);X(s).then(r=>{c.value=p,f("删除成功")}).catch(({message:r})=>f(r))}else c.value.forEach(s=>s.isSelect=!1)};return m.onBack=()=>o.value?(h(),!1):!0,(e,s)=>{const p=ee,r=ne,j=ae,F=te,k=se,w=oe;return l(),d(B,null,[a("div",ue,[i(p,{fixed:"","left-arrow":"",placeholder:"",title:"阅读历史","right-text":"编辑",onClickLeft:s[0]||(s[0]=t=>O(m).back()),onClickRight:R}),a("div",pe,[_.value?(l(),$(r,{key:0,description:"暂无阅读数据"})):(l(),$(F,{key:1,direction:"vertical",fill:"",size:"16px"},{default:u(()=>[(l(!0),d(B,null,G(c.value,t=>{var x;return l(),d("div",{class:"item",onClick:y=>b(t)},[a("img",{src:t.cover,alt:t.name},null,8,fe),a("div",me,[a("div",he,E(t.name),1),a("div",ye,E(((x=t==null?void 0:t.readToChapter)==null?void 0:x.name)||"-"),1)]),a("button",{class:"btn",onClick:J(y=>z(t),["stop"])},[o.value?(l(),d("button",{key:0,class:K(["select",{active:t.isSelect}])},[i(j,{name:"success",size:"18"})],2)):!o.value&&t.inShelf?(l(),d("span",{key:1,class:"open",onClick:y=>A(t)},"打开",8,Ce)):!o.value&&!t.inShelf?(l(),d("span",{key:2,class:"add-shelf",onClick:y=>S(t)},"加入书架",8,Se)):Q("",!0)],8,ge)],8,ve)}),256))]),_:1})),i(_e,{loading:C.value},null,8,["loading"])])]),i(k,{overlay:!1,show:o.value,"onUpdate:show":s[1]||(s[1]=t=>o.value=t),position:"top"},{default:u(()=>[i(p,{title:"请选择图书","right-text":"全选",onClickRight:T})]),_:1},8,["show"]),i(k,{overlay:!1,show:o.value,"onUpdate:show":s[4]||(s[4]=t=>o.value=t),position:"bottom"},{default:u(()=>[a("div",ke,[i(w,{icon:"delete",type:"danger",block:"",onClick:s[2]||(s[2]=t=>h(!0))},{default:u(()=>[I("删除")]),_:1}),i(w,{icon:"revoke",type:"default",block:"",onClick:s[3]||(s[3]=t=>h(!1))},{default:u(()=>[I("取消")]),_:1})])]),_:1},8,["show"])],64)}}});const ze=V(we,[["__scopeId","data-v-2e7e3af0"]]);export{ze as default};
